@page "/registro"
@inject DatabaseService DatabaseService;
@inject NavigationManager NavigationManager;

<h1 id = "register-page">Alta de funcionario</h1>
<form id= "alert alert-danger" @onsubmit="OnSubmitForm">
    <label>Nombre</label> 
    <input type="text" name="name" id="name" placeholder="Ingrese su nombre" @bind="name">
    <label>Apellido</label>
    <input type="text" name="lastName" id="lastName" placeholder="Ingrese su apellido" @bind="lastName">
    <label>Cédula de identidad</label> 
    <input type="text" name="ci" id="ci" placeholder="Ingrese su cedula" @bind="ci">
    <label>Contraseña</label> 
    <input type="password" name="password" id="password" placeholder="Ingrese una contraseña" @bind="password">
    <label>Fecha de nacimiento</label>
    <input type="date" name="bithDate" id="birthDate" placeholder="Ingrese su fecha de nacimiento" @bind="birthDate"> 
    <label>Ingrese su domicilio completo</label> 
    <input type="text" name="domicilioCompleto" id="domicilioCompleto" placeholder="Ingrese su domicilio de residencia" @bind="address"> 
    <label>Ingrese su correo electrónico</label> 
    <input type="text" name="correo" id="correo" placeholder="Ingrese su correo electrónico" @bind="email"> 
    <label>Ingrese su teléfono de contacto</label>
    <input type="text" name="telefono" id="telefono" placeholder="Ingrese su teléfono" @bind="telephone"> 
    <button id="botonRegistro" type="submit" class="btn btn-primary">Registrarse</button>
    @if(alert_str == true)
        {
        <div class="alert alert-success" role="alert">
             @alert_str
        </div>
        }
</form>


@code {
    private int ci;
    private string name = "";
    private DateTime birthDate;
    private string address = "";
    private string email = "";
    private int telephone = 0;
    private string lastName = "";
    private string password = "";
    public bool alert_str = false;


    private async Task<bool> OnSubmitForm()
    {
        DatabaseService dbs = new DatabaseService();
        bool check = false;
        try
        {
            if (check)
            {
                var hashedPassword = MD5Hash.Hash.Content(password);
                dbs.RegisterUser(hashedPassword);
                alert_str = true;
                NavigationManager.NavigateTo("/Carnet");
            }
            else
            {
                Console.WriteLine("Campos incompletos");
            }
        }
        catch (Exception e)
        {
            check = true;
            Console.WriteLine(e);
        }
        return check;
        } 

    
}



