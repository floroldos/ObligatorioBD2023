@page "/registro"
@inject DatabaseService DatabaseService;

    <h1 id = "register-page">Alta de funcionario</h1>
    <form id= "alert alert-danger" @onsubmit="OnSubmitForm">
    <label>Cédula de identidad</label> 
    <input type="text" name="ci" id="ci" placeholder="Ingrese su cedula" @bind="ci">
    <label>Nombre</label> 
    <input type="text" name="nombre" id="nombre" placeholder="Ingrese su nombre" @bind="name">
    <label>Apellido</label>
    <input type="text" name="apellido" id="apellido" placeholder="Ingrese su apellido" @bind="lastName">
    <label>Fecha de nacimiento</label>
    <input type="date" name="fechaN" id="FechaN" placeholder="Ingrese su fecha de nacimiento" @bind="birthDate"> 
    <hr> 
    <label for="tieneCarnetSalud">¿Tiene carnet de salud vigente?</label><br>
        <div id="opcionesCarnetSalud" class = "form-check">
            <input class="form-check-input" type="checkbox" id="carnetSi" @bind="showDocument" /> Si
            <br>
            <input class="form-check-input" type="checkbox" id="carnetNo" @bind="showAgenda" /> No
        </div>
        @if (showDocument)
        {
        <div id="uploadDocument">
            <label for="documentoInput">Subir comprobante de carné de salud</label>
            <input type="file" id="documentoInput" accept=".jpg, .pdf" name="documentoInput">
            <label>Fecha de emisión:</label>
            <input type="date" name="fechaE" id="FechaE" placeholder="Ingrese la fecha de emisión">
            <label>Fecha de vencimiento:</label>
            <input type="date" name="fechaV" id="FechaV" placeholder="Ingrese la fecha de vencimiento">
        </div>
        }
        @if (showAgenda){
        <p>Usted debe tener el carné de salud al día. Agende una cita médica para poder continuar.</p>
        <div id="bookAppointment">
            <a href="/RegistroAgenda">Agendar Cita</a>
        </div>
        }
    <hr>
    <label>Ingrese su domicilio completo</label> 
    <input type="text" name="domicilioCompleto" id="domicilioCompleto" placeholder="Ingrese su domicilio de residencia" @bind="address"> 
    <label>Ingrese su correo electrónico</label> 
    <input type="text" name="correo" id="correo" placeholder="Ingrese su correo electrónico" @bind="email"> 
    <label>Ingrese su teléfono de contacto</label>
    <input type="text" name="telefono" id="telefono" placeholder="Ingrese su teléfono" @bind="telephone"> 
    <button id="botonRegistro" type="submit" class="btn btn-primary">Registrarse</button>
</form>

@code {
    private bool showDocument = false;
    private bool showAgenda = false;
    private string ci = "";
     private string name = "";
    private DateTime birthDate;
    private string address = "";
    private string email = "";
    private int telephone = 0;
    private string lastName = "";
    private async Task<bool> OnSubmitForm()
    {
        bool check = false;
    try
    {
        DatabaseService.InsertWorker(ci, name, lastName, birthDate, address, telephone, email);
    }
    catch (Exception e)
    {
        check = true;
        Console.WriteLine(e);
    }
    return check;
}
        
}



